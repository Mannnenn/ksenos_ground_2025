launch:
  - group:
      - push-ros-namespace:
          namespace: "controller"

      - group:
          - push-ros-namespace:
              namespace: "mode_selector"

          - node:
              pkg: ksenos_ground
              exec: mode_auto_turning
              name: auto_turning_node
              param:
                - name: target_radius
                  value: 5.0
              remap:
                - from: "sbus_data"
                  to: "/sbus/manual/sbus_data"
                - from: "target_turning_radius"
                  to: "/controller/lat/calc/turning_radius"

          - node:
              pkg: ksenos_ground
              exec: calc_flight_distance
              name: calc_flight_distance_node
              remap:
                - from: "sbus_data"
                  to: "/sbus/manual/sbus_data"
                - from: "flow_rate_data"
                  to: "/sensor/flow_rate"
                - from: "flight_distance"
                  to: "/controller/mode_selector/flight_distance"

          # - node:
          #     pkg: ksenos_ground
          #     exec: mode_eight_turning
          #     name: eight_turning_node
          #     param:
          #       - name: target_turning_radius
          #         value: 5.0
          #     remap:
          #       - from: "sbus_data"
          #         to: "/sbus/manual/sbus_data"
          #       - from: "flight_distance"
          #         to: "/controller/mode_selector/flight_distance"
          #       - from: "turn_radius"
          #         to: "/controller/lat/calc/turning_radius"

          - node:
              pkg: ksenos_ground
              exec: mode_eight_turning_angle
              name: eight_turning_node
              param:
                - name: lobe_span_deg
                  value: 270.0
                - name: max_turn_radius
                  value: 6.0
                - name: min_turn_radius
                  value: 2.5
              remap:
                - from: "sbus_data"
                  to: "/sbus/manual/sbus_data"
                - from: "serialized_yaw"
                  to: "/sensor/serialized_yaw_angle"
                - from: "turn_radius"
                  to: "/controller/lat/calc/turning_radius"

          - node:
              pkg: ksenos_ground
              exec: mode_rise_turning
              name: rise_turning_node
              param:
                - name: altitude_offset
                  value: 3.5
                - name: lap_count_initial
                  value: 3
                - name: lap_count_transition
                  value: 2
                - name: target_radius
                  value: -5.0
              remap:
                - from: "sbus_data"
                  to: "/sbus/manual/sbus_data"
                - from: "serialized_yaw"
                  to: "/sensor/serialized_yaw_angle"
                - from: "average_altitude"
                  to: "/controller/long/calc/average_altitude_imu"
                - from: "target_altitude_rise_turning"
                  to: "/controller/long/calc/dynamic_altitude"
                - from: "target_turning_radius"
                  to: "/controller/lat/calc/turning_radius"
