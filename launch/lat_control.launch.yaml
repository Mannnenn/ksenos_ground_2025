launch:
  - group:
      - push-ros-namespace:
          namespace: "controller"

      - group:
          - push-ros-namespace:
              namespace: "lat"

          - group:
              - push-ros-namespace:
                  namespace: "calc"

              - node:
                  pkg: ksenos_ground
                  exec: turningRadius_to_latAcc
                  name: lateral_acceleration_calculator_node
                  param:
                    - name: low_pass_filter_alpha
                      value: 0.1 # ローパスフィルターのアルファ値（0.1 = 10%の新しいデータを使用）
                  remap:
                    - from: "/controller/lat/calc/lateral_acceleration"
                      to: "/controller/lat/lateral_acceleration"

              - node:
                  pkg: ksenos_ground
                  exec: latAcc_to_targetRollAngle
                  name: lat_acc_to_target_roll_angle_node
                  output: screen
                  param:
                    - name: max_roll_angle
                      value: 0.524 # 最大ロール角度（ラジアン）
                  remap:
                    - from: "/controller/lat/calc/lateral_acceleration"
                      to: "/controller/lat/lateral_acceleration"
                    - from: "/controller/lat/calc/target_roll_angle"
                      to: "/controller/lat/target_roll_angle"

          - group:
              - push-ros-namespace:
                  namespace: "control"

              - node:
                  pkg: "ksenos_ground"
                  exec: "control_aileron"
                  name: "control_aileron_node"
                  param:
                    - name: kp
                      value: 1.0 # P制御ゲイン（要調整）
                    - name: kd
                      value: 0.1 # D制御ゲイン（要調整）
                    - name: max_aileron
                      value: 0.6 # 最大エルロン値
                    - name: min_aileron
                      value: -0.6 # 最小エルロン値
                  remap:
                    - from: "/aileron_input"
                      to: "/controller/lat/aileron_input"
                    - from: "/controller/lat/calc/target_roll_angle"
                      to: "/controller/lat/target_roll_angle"

              - node:
                  pkg: "ksenos_ground"
                  exec: "control_rudder"
                  name: "control_rudder_node"
                  param:
                    - name: kp
                      value: 1.0 # P制御ゲイン（要調整）
                    - name: ki
                      value: 0.0 # I制御ゲイン（要調整）
                    - name: ff_lat_acc_gain
                      value: 0.0 # FF制御ゲイン（要調整）
                    - name: ff_aileron_gain
                      value: 0.0 # FF制御ゲイン（要調整）
                    - name: max_rudder
                      value: 0.6 # 最大ラダー値
                    - name: min_rudder
                      value: -0.6 # 最小ラダー値
                    - name: max_integral
                      value: 1.0 # 最大積分値
                  remap:
                    - from: "/aileron_input"
                      to: "/controller/lat/aileron_input"
                    - from: "/rudder_input"
                      to: "/controller/lat/rudder_input"
                    - from: "/controller/lat/calc/lateral_acceleration"
                      to: "/controller/lat/lateral_acceleration"
